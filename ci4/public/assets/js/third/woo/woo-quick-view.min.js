var $j=jQuery.noConflict();$j(document).ready(function(){if("undefined"==typeof woovinaLocalize)return!1;var e=$j("#wvn-qv-wrap"),a=$j("#wvn-qv-content");$j(document).on("click",".wvn-quick-view",function(t){t.preventDefault();var n=$j(this),i=$j(this).data("product_id");n.parent().addClass("loading"),$j.ajax({url:woovinaLocalize.ajax_url,data:{action:"woovina_product_quick_view",product_id:i},success:function(t){var n=$j("html").innerWidth();$j("html").css("overflow","hidden");var i=$j("html").innerWidth();$j("html").css("margin-right",i-n),$j("html").addClass("wvn-qv-open"),a.html(t),e.fadeIn(),e.addClass("is-visible");var r=a.find(".variations_form");r.trigger("check_variations"),r.trigger("reset_image");var o=a.find(".variations_form");o.length>0&&(o.wc_variation_form(),o.find("select").change());var d=a.find(".wvn-qv-image");d.find("li").length>1&&("gallery-slider"==woovinaLocalize.quickviewGalleryStyle||"true"==woovinaLocalize.isMobile||n<1024)?d.flexslider():(a.addClass("gallery-scroller"),setTimeout(function(){a.find("ul.wvn-qv-slides").css("max-height",a.find(".summary.entry-summary").innerHeight())},250));var c=a.find("form.grouped_form");if(c){var l=a.find("form.grouped_form").attr("action");c.find(".group_table, button.single_add_to_cart_button").hide(),c.append(' <a href="'+l+'" class="button">'+woovinaLocalize.grouped_text+"</a>")}}}).done(function(){n.parent().removeClass("loading")})});var t=function(){$j("html").css({overflow:"","margin-right":""}),$j("html").removeClass("wvn-qv-open"),e.fadeOut(),e.removeClass("is-visible"),setTimeout(function(){a.html("")},600)};$j(".wvn-qv-overlay, .wvn-qv-close").on("click",function(e){e.preventDefault(),t()}),$j(document).keyup(function(e){27==e.keyCode&&t()}),$j.fn.serializeArrayAll=function(){var e=/\r?\n/g;return this.map(function(){return this.elements?jQuery.makeArray(this.elements):this}).map(function(a,t){var n=jQuery(this).val();return null==n?null==n:"checkbox"==this.type&&0==this.checked?{name:this.name,value:this.checked?this.value:""}:"radio"==this.type&&0==this.checked?{name:this.name,value:this.checked?this.value:""}:jQuery.isArray(n)?jQuery.map(n,function(a,n){return{name:t.name,value:a.replace(e,"\r\n")}}):{name:t.name,value:n.replace(e,"\r\n")}}).get()};var n=function(){$j(document.body).on("click","#wvn-qv-content .product:not(.product-type-external) .single_add_to_cart_button",this.onAddToCart).on("added_to_cart",this.updateButton)};n.prototype.onAddToCart=function(e){e.preventDefault();var a=$j(this),t=$j(this).closest("form.cart").serializeArrayAll(),n=!1;$j.each(t,function(e,a){if("add-to-cart"===a.name)return n=!0,!1}),n&&(e.preventDefault(),$j(document.body).trigger("adding_to_cart",[a,t]),a.removeClass("added"),a.addClass("loading"),$j.ajax({url:woovinaLocalize.wc_ajax_url,type:"POST",data:t,success:function(e){$j(document.body).trigger("wc_fragment_refresh"),$j(document.body).trigger("added_to_cart",[e.fragments,e.cart_hash,a]),"yes"!==woovinaLocalize.cart_redirect_after_add||(window.location=woovinaLocalize.cart_url)}}))},n.prototype.updateButton=function(e,a,t,n){(n=void 0!==n&&n)&&(n.removeClass("loading"),n.addClass("added"),woovinaLocalize.is_cart||0!==n.parent().find(".added_to_cart").length||n.after(' <a href="'+woovinaLocalize.cart_url+'" class="added_to_cart wc-forward" title="'+woovinaLocalize.view_cart+'">'+woovinaLocalize.view_cart+"</a>"))},new n});